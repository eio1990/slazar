# –ê—É–¥–∏—Ç —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó –º–æ–¥—É–ª—è –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞

**–î–∞—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:** 2025  
**–î–æ–∫—É–º–µ–Ω—Ç –¢–ó:** –ú–æ–¥—É–ª—å ¬´–†—É—Ö–∏ –∑–∞–ø–∞—Å—ñ–≤¬ª - –ï—Ç–∞–ø–∏ —Ü–∏–∫–ª—É –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞

---

## –õ–µ–≥–µ–Ω–¥–∞

- ‚úÖ **–ü–æ–≤–Ω—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ** - —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –ø—Ä–∞—Ü—é—î –∑–≥—ñ–¥–Ω–æ –¢–ó
- ‚ö†Ô∏è **–ß–∞—Å—Ç–∫–æ–≤–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ** - —î –±–∞–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –∞–ª–µ –Ω–µ –≤—Å—ñ –¥–µ—Ç–∞–ª—ñ
- ‚ùå **–ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ** - —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –≤—ñ–¥—Å—É—Ç–Ω—ñ–π
- üîß **–ü–æ—Ç—Ä–µ–±—É—î –¥–æ—Ä–æ–±–∫–∏** - —î —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∞–ª–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∑–º—ñ–Ω–∏

---

## 2.1. –°—Ç–∞—Ä—Ç –ø–∞—Ä—Ç—ñ—ó

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–í–∏–±—ñ—Ä —Ä–µ—Ü–µ–ø—Ç—É:**
- ‚úÖ API: `POST /api/production/batches` –ø—Ä–∏–π–º–∞—î `recipe_id`
- ‚úÖ Frontend: –ï–∫—Ä–∞–Ω `/recipes/[id].tsx` –∑ —Ñ–æ—Ä–º–æ—é —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä—Ç—ñ—ó
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ä–µ—Ü–µ–ø—Ç—É

**–í–≤—ñ–¥ —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö –º–∞—Å —Å–∏—Ä–æ–≤–∏–Ω–∏:**
- ‚úÖ –ü–æ–ª–µ `initial_weight` –≤ `BatchCreate`
- ‚úÖ Frontend input –∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é > 0
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ —Ç–∞–±–ª–∏—Ü—ñ `batches`

**–§—ñ–∫—Å–∞—Ü—ñ—è —Å—Ç–∞—Ä—Ç—É:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è `batch_number` (BATCH-DDMMYYYY-XXX)
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è `started_at` timestamp
- ‚úÖ –°—Ç–∞—Ç—É—Å `created`

**–û–±—Ä—ñ–∑–∫–∏ (trim):**
- ‚úÖ –ü–∏—Ç–∞–Ω–Ω—è "–ë—É–ª–∏ –æ–±—Ä—ñ–∑–∫–∏?" –Ω–∞ frontend
- ‚úÖ –ü–æ–ª—è `trim_waste`, `trim_returned`
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –ø–∞—Ä—Ç—ñ—ó

### ‚ùå –ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–í–≤—ñ–¥ –≤–æ–¥–∏ –¥–ª—è –∑–∞—Å–æ–ª–∫–∏:**
```
–¢–ó: "–≤–≤—ñ–¥ —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö –º–∞—Å—Å —Å–∏—Ä–æ–≤–∏–Ω–∏ —Ç–∞ –≤–æ–¥–∏ (—è–∫—â–æ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–æ —Ä–µ—Ü–µ–ø—Ç–æ–º)"
```
- ‚ùå –ù–µ–º–∞—î –æ–∫—Ä–µ–º–æ–≥–æ –ø–æ–ª—è –¥–ª—è –≤–æ–¥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
- ‚ùå –í–æ–¥–∞ –Ω–µ –ø—Ä–∏–≤'—è–∑–∞–Ω–∞ –¥–æ –µ—Ç–∞–ø—É "–∑–∞—Å–æ–ª–∫–∞"
- ‚ùå –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ `water_per_100kg` —î –≤ —Ä–µ—Ü–µ–ø—Ç—ñ, –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–æ–¥–∞—Ç–∏ –ø–æ–ª–µ `water_used` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ –¥–ª—è —Ä–µ—Ü–µ–ø—Ç—ñ–≤ —Ç–∏–ø—É –ë–∞—Å—Ç—É—Ä–º–∞

---

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –∑–∞–ª–∏—à–∫—ñ–≤:**
```
–¢–ó: "–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –æ—Å—Ç–∞—Ç–∫—ñ–≤ –ø–æ –≤–≤–æ–¥–∏–º–∏–º –ø–æ–∑–∏—Ü—ñ—è–º"
```
- ‚ùå –ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –ø–∞—Ä—Ç—ñ—ó –ù–ï –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Å–∏—Ä–æ–≤–∏–Ω–∏ –Ω–∞ —Å–∫–ª–∞–¥—ñ
- ‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞—Ä—Ç—ñ—é –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å–∏—Ä–æ–≤–∏–Ω–∏ –Ω–µ–º–∞—î

**–ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```typescript
// frontend/app/recipes/[id].tsx
handleCreateBatch() {
  // –¢—ñ–ª—å–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–≤–µ–¥–µ–Ω–Ω—è, –ë–ï–ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–∫–ª–∞–¥—É!
  if (!initialWeight || parseFloat(initialWeight) <= 0) {
    Alert.alert('–ü–æ–º–∏–ª–∫–∞', '–í–≤–µ–¥—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤—É –≤–∞–≥—É');
    return;
  }
  createBatchMutation.mutate(...)
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–æ–¥–∞—Ç–∏ GET –∑–∞–ø–∏—Ç –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º:
```typescript
// –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–∞–ª–∞–Ω—Å —Å–∏—Ä–æ–≤–∏–Ω–∏
const balance = await fetch(`/api/stock/balance/${product_id}`);
if (balance < initial_weight) {
  Alert.alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Å–∏—Ä–æ–≤–∏–Ω–∏ –Ω–∞ —Å–∫–ª–∞–¥—ñ');
  return;
}
```

---

**–°–ø–∏—Å–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ:**
```
–¢–ó: "—Å–ø–∏—Å–∞–Ω—ñ–π –≤–≤–µ–¥—ë–Ω–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤"
```
- ‚ö†Ô∏è API —ñ—Å–Ω—É—î: `POST /api/production/batches/{id}/materials/consume`
- ‚ùå –ù–ï –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –ø–∞—Ä—Ç—ñ—ó
- ‚ùå Frontend —Ñ–æ—Ä–º–∞ –¥–ª—è —Å–ø–∏—Å–∞–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –í–Ü–î–°–£–¢–ù–Ø

**–ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```python
# backend/production_api.py - —î endpoint
@router.post("/batches/{batch_id}/materials/consume")
async def consume_materials(...)
  # –°–ø–∏—Å—É—î –º–∞—Ç–µ—Ä—ñ–∞–ª–∏, –∞–ª–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –í–†–£–ß–ù–£
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** 
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `/materials/consume` –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä—Ç—ñ—ó
2. –ê–±–æ –¥–æ–¥–∞—Ç–∏ –æ–∫—Ä–µ–º–∏–π –∫—Ä–æ–∫ "–°–ø–∏—Å–∞–Ω–Ω—è —Å–∏—Ä–æ–≤–∏–Ω–∏" –≤ UI

---

### –ü—ñ–¥—Å—É–º–æ–∫ 2.1:
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä—Ç—ñ—ó: **80%**
- ‚ùå –í–≤—ñ–¥ –≤–æ–¥–∏: **0%**
- ‚ùå –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–∏—à–∫—ñ–≤: **0%**
- ‚ö†Ô∏è –°–ø–∏—Å–∞–Ω–Ω—è —Å–∏—Ä–æ–≤–∏–Ω–∏: **API 100%, Frontend 0%, –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è 0%**

**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 50%**

---

## 2.2. –î–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ø–µ—Ü–∏–π / –º–∞—Ä–∏–Ω–∞–¥—É

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**API –¥–ª—è –º—ñ–∫—Å–∞:**
- ‚úÖ `POST /api/production/batches/{id}/mix`
- ‚úÖ –ú–æ–¥–µ–ª—å `BatchMixProduction` –∑ —É—Å—ñ–º–∞ –ø–æ–ª—è–º–∏
- ‚úÖ –¢–∞–±–ª–∏—Ü—è `batch_mix_production`

**–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∏—Ä–æ–±–ª–µ–Ω–æ–≥–æ –º—ñ–∫—Å–∞:**
- ‚úÖ –§—É–Ω–∫—Ü—ñ—è `calculate_produced_mix(spices)`
- ‚úÖ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏: `FENUGREEK_ID = 19`, `WATER_ID = 71`, `FENUGREEK_WATER_RATIO = 4`
- ‚úÖ –§–æ—Ä–º—É–ª–∞: `total + fenugreek + (fenugreek √ó 4)`

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∫–ª–∞–¥—Å—å–∫–æ–≥–æ –º—ñ–∫—Å–∞:**
- ‚úÖ –ü–æ–ª–µ `warehouse_mix_used`
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –Ω–∞ —Å–∫–ª–∞–¥—ñ
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä—É—Ö—É `withdrawal`
- ‚úÖ –ü–æ–º–∏–ª–∫–∞ —è–∫—â–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ

**–ó–∞–ª–∏—à–æ–∫ –º—ñ–∫—Å–∞:**
- ‚úÖ –ü–æ–ª–µ `leftover_quantity`
- ‚úÖ –ü—Ä–∏—Ö–æ–¥—É–≤–∞–Ω–Ω—è –Ω–∞ —Å–∫–ª–∞–¥ (receipt)
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è `stock_balances`

**–û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–µ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ:**
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `idempotency_key`
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–µ —Å—Ç–≤–æ—Ä—é—î –¥—É–±–ª—ñ–≤

### ‚ùå –ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**Frontend —Ñ–æ—Ä–º–∞ –¥–ª—è —Å–ø–µ—Ü–∏–π:**
```
–¢–ó: "–í–≤–æ–¥: —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—Ö–æ–¥ —Å–ø–µ—Ü–∏–π (–ø–æ —Ä–µ—Ü–µ–ø—Ç—É)"
```
- ‚ùå –ù–µ–º–∞—î —Ñ–æ—Ä–º–∏ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è —Å–ø–µ—Ü–∏–π –≤ UI
- ‚ùå –ù–µ–º–∞—î –µ–∫—Ä–∞–Ω—É –¥–ª—è –∫—Ä–æ–∫—É "mix"
- ‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –º–æ–∂–µ –≤–≤–µ—Å—Ç–∏ —Ñ–∞–∫—Ç–∏—á–Ω—ñ –≤–∞–≥–∏ —Å–ø–µ—Ü–∏–π

**–ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```typescript
// frontend/app/batches/[id].tsx
// –Ñ –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø—Ä–æ–≥—Ä–µ—Å, –∞–ª–µ –¥–ª—è –∫—Ä–æ–∫—É "mix" –ø—Ä–æ—Å—Ç–æ Alert.prompt
// –ù–ï–ú–ê–Ñ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ—ó —Ñ–æ—Ä–º–∏ –∑—ñ —Å–ø–∏—Å–∫–æ–º —Å–ø–µ—Ü–∏–π!
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –°—Ç–≤–æ—Ä–∏—Ç–∏ –µ–∫—Ä–∞–Ω `/batches/[id]/mix-form.tsx`:
- –°–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–π –∑ —Ä–µ—Ü–µ–ø—Ç—É
- Input –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–ø–µ—Ü–∏—ó
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–æ–¥–∏ –¥–ª—è –ø–∞–∂–∏—Ç–Ω–∏–∫–∞
- –ü–æ–ª–µ leftover
- Checkbox –¥–ª—è —Å–∫–ª–∞–¥—Å—å–∫–æ–≥–æ –º—ñ–∫—Å–∞

---

**–ó–∞–±–æ—Ä–æ–Ω–∞ –º—ñ–∫—Å–∞ —è–∫ –≤—Ö—ñ–¥–Ω–æ—ó —Å–ø–µ—Ü–∏—ó:**
```
–¢–ó: "—Å–∞–º ¬´–º—ñ–∫—Å¬ª –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ —É–∫–∞–∑–∞–Ω —è–∫ –∏—Å—Ö–æ–¥–Ω–∞—è —Å–ø–µ—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–∞"
```
- ‚ùå –í–∞–ª—ñ–¥–∞—Ü—ñ—è –í–Ü–î–°–£–¢–ù–Ø –≤ API
- ‚ùå –í–∞–ª—ñ–¥–∞—Ü—ñ—è –í–Ü–î–°–£–¢–ù–Ø –≤ seed —Ä–µ—Ü–µ–ø—Ç—ñ–≤
- ‚ùå –¢–µ—Ö–Ω—ñ—á–Ω–æ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –º—ñ–∫—Å —è–∫ —Å–ø–µ—Ü–∏—é –≤ `recipe_spices`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–æ–¥–∞—Ç–∏ –≤ `seed_recipes_simple.py`:
```python
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ nomenclature_id –ù–ï —î –º—ñ–∫—Å–æ–º (134, 135)
if nomenclature_id in [134, 135]:
    raise ValueError("–ú—ñ–∫—Å –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤—Ö—ñ–¥–Ω–æ—é —Å–ø–µ—Ü–∏—î—é!")
```

---

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:**
```
–¢–ó: "—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´—Å—É—Ö–æ–π –≤–µ—Å¬ª –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)"
```
- ‚ö†Ô∏è –Ñ –ø–æ–ª–µ `parameters` –≤ `batch_operations`
- ‚ùå –ù–µ–º–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ–≥–æ –≤–≤–æ–¥—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –Ω–∞ frontend

---

### –ü—ñ–¥—Å—É–º–æ–∫ 2.2:
- ‚úÖ Backend API: **95%**
- ‚úÖ –õ–æ–≥—ñ–∫–∞ –º—ñ–∫—Å–∞: **100%**
- ‚ùå Frontend —Ñ–æ—Ä–º–∞: **0%**
- ‚ùå –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞–±–æ—Ä–æ–Ω–∏ –º—ñ–∫—Å–∞: **0%**

**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 50%**

---

## 2.3. –ó–∞–∫—Ä–∏—Ç—Ç—è –ø–∞—Ä—Ç—ñ—ó

### ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–í–≤—ñ–¥ —Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó –≤–∞–≥–∏:**
- ‚úÖ API: `PUT /api/production/batches/{id}/complete`
- ‚úÖ –ú–æ–¥–µ–ª—å `BatchComplete` –∑ –ø–æ–ª–µ–º `final_weight`
- ‚úÖ Frontend —Ñ–æ—Ä–º–∞ –≤ `/batches/[id].tsx`
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è > 0

**–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∏—Ö–æ–¥—É:**
- ‚úÖ –§–æ—Ä–º—É–ª–∞: `(final_weight / initial_weight) √ó 100`
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ API
- ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞ frontend
- ‚úÖ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ `expected_yield_min/max` –∑ —Ä–µ—Ü–µ–ø—Ç—É

**–ü—Ä–∏—Ö—ñ–¥ –≥–æ—Ç–æ–≤–æ—ó –ø—Ä–æ–¥—É–∫—Ü—ñ—ó:**
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä—É—Ö—É `receipt` –¥–ª—è `target_product_id`
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è `stock_balances`
- ‚úÖ Metadata –∑ `batch_id`, `batch_number`, `yield_percent`

**–§—ñ–Ω–∞–ª—å–Ω–∏–π —Å—Ç–∞—Ç—É—Å:**
- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è `status = 'completed'`
- ‚úÖ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è `completed_at = GETDATE()`
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è `final_weight`

**–Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å:**
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `idempotency_key` –≤ `stock_movements`
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–µ —Å—Ç–≤–æ—Ä—é—î –¥—É–±–ª—ñ–≤

### –ü—ñ–¥—Å—É–º–æ–∫ 2.3:
**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 100%** ‚úÖ

---

## 3. –§—ñ–∫—Å–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–æ –ø–∞—Ä—Ç—ñ—é

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–¢–∞–±–ª–∏—Ü—è `batches`:**
```sql
- id ‚úÖ
- batch_number ‚úÖ (—Ñ–æ—Ä–º–∞—Ç BATCH-DDMMYYYY-XXX)
- recipe_id ‚úÖ (–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–µ—Ü–µ–ø—Ç)
- status ‚úÖ (created, in_progress, completed)
- current_step ‚úÖ (–Ω–æ–º–µ—Ä –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫—Ä–æ–∫—É)
- started_at ‚úÖ
- completed_at ‚úÖ
- initial_weight ‚úÖ
- final_weight ‚úÖ
- trim_waste ‚úÖ
- trim_returned ‚úÖ
- operator_notes ‚úÖ
```

**–¢–∞–±–ª–∏—Ü—è `batch_operations`:**
```sql
- –í—Å—ñ –µ—Ç–∞–ø–∏ –ø–∞—Ä—Ç—ñ—ó ‚úÖ
- weight_before, weight_after ‚úÖ
- parameters (JSON) ‚úÖ
- idempotency_key ‚úÖ
```

**–¢–∞–±–ª–∏—Ü—è `batch_mix_production`:**
```sql
- produced_quantity ‚úÖ
- used_quantity ‚úÖ
- leftover_quantity ‚úÖ
- warehouse_mix_used ‚úÖ
```

**–¢–∞–±–ª–∏—Ü—è `batch_materials`:**
```sql
- –í—Å—ñ –≤–∏—Ç—Ä–∞—á–µ–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ ‚úÖ
- nomenclature_id, material_type, quantity_used ‚úÖ
- movement_id (–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä—É—Ö) ‚úÖ
```

### ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–í–µ—Ä—Å—ñ—è —Ä–µ—Ü–µ–ø—Ç—É:**
```
–¢–ó: "—Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç (–≤–µ—Ä—Å–∏—è)"
```
- ‚ö†Ô∏è –Ñ `recipe_id`, –∞–ª–µ –ù–ï–ú–ê–Ñ –≤–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ—Ü–µ–ø—Ç—ñ–≤
- ‚ö†Ô∏è –Ø–∫—â–æ —Ä–µ—Ü–µ–ø—Ç –∑–º—ñ–Ω–∏—Ç–∏, —Å—Ç–∞—Ä—ñ –ø–∞—Ä—Ç—ñ—ó –±—É–¥—É—Ç—å –ø–æ—Å–∏–ª–∞—Ç–∏—Å—å –Ω–∞ –∑–º—ñ–Ω–µ–Ω–∏–π —Ä–µ—Ü–µ–ø—Ç

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–æ–¥–∞—Ç–∏:
```sql
ALTER TABLE batches ADD recipe_version INT;
ALTER TABLE recipes ADD version INT DEFAULT 1;
```

**–í–∞–≥–∞ –≤–æ–¥–∏ –Ω–∞ –µ—Ç–∞–ø–∞—Ö:**
```
–¢–ó: "–í–≤–µ–¥—ë–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ—Å–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ (—Å—ã—Ä—å—ë, –≤–æ–¥–∞, —Å–ø–µ—Ü–∏–∏...)"
```
- ‚ö†Ô∏è –Ñ `batch_operations.weight_after`, –∞–ª–µ –ù–ï–ú–ê–Ñ –æ–∫—Ä–µ–º–æ–≥–æ –ø–æ–ª—è –¥–ª—è –≤–æ–¥–∏
- ‚ö†Ô∏è –í–æ–¥–∞ –Ω–µ —Ñ—ñ–∫—Å—É—î—Ç—å—Å—è —è–∫ –æ–∫—Ä–µ–º–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä

### –ü—ñ–¥—Å—É–º–æ–∫ 3:
**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 85%**

---

## 4. –Ü–Ω–≤–∞—Ä—ñ–∞–Ω—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**1. –ù–µ —Å—Ç–∞—Ä—Ç—É–≤–∞—Ç–∏ –∑ –Ω—É–ª–µ–º:**
```typescript
// frontend/app/recipes/[id].tsx
if (!initialWeight || parseFloat(initialWeight) <= 0) {
  Alert.alert('–ü–æ–º–∏–ª–∫–∞', '–í–≤–µ–¥—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤—É –≤–∞–≥—É');
}
```
‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ frontend

**2. –ù–µ —Å–ø–∏—Å—É–≤–∞—Ç–∏ –±–µ–∑ –∑–∞–ª–∏—à–∫—ñ–≤:**
```python
# backend/production_api.py:464
if current_balance < quantity:
    raise HTTPException(
        status_code=400,
        detail=f"Insufficient stock for {material_name}"
    )
```
‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤ API `/materials/consume`

**3. –ú—ñ–∫—Å –æ–¥–∏–Ω —Ä–∞–∑:**
```python
# backend/production_api.py:371
cursor.execute(
    "SELECT id FROM batch_mix_production WHERE idempotency_key = ?",
    mix_data.idempotency_key
)
if cursor.fetchone():
    return {"message": "Mix already produced"}
```
‚úÖ –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å

**4. –û–∫—Ä—É–≥–ª–µ–Ω–Ω—è:**
- ‚úÖ –Ñ `precision_digits` –≤ `nomenclature`
- ‚ö†Ô∏è –§—É–Ω–∫—Ü—ñ—è `round_quantity` —ñ—Å–Ω—É—î –≤ `server.py`, –∞–ª–µ –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ production API

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è:
```python
from server import round_quantity
# –ü—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ weight_after
rounded = round_quantity(weight_after, precision)
```

### ‚ùå –ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**5. UTC —á–∞—Å–æ–≤—ñ –º—ñ—Ç–∫–∏:**
```
–¢–ó: "–í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ ‚Äî –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ UTC)"
```
- ‚ùå –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `GETDATE()` –≤ SQL Server = **LOCAL TIME**
- ‚ùå –ù–µ UTC!

**–ü–æ—Ç–æ—á–Ω–∏–π –∫–æ–¥:**
```python
cursor.execute("""
    INSERT INTO batches (started_at) 
    VALUES (GETDATE())  # ‚Üê LOCAL TIME, not UTC!
""")
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –ó–º—ñ–Ω–∏—Ç–∏ –≤—Å—ñ `GETDATE()` –Ω–∞ `GETUTCDATE()`:
```python
# –ì–ª–æ–±–∞–ª—å–Ω–∞ –∑–∞–º—ñ–Ω–∞ –≤ production_api.py
sed -i 's/GETDATE()/GETUTCDATE()/g' production_api.py
```

### –ü—ñ–¥—Å—É–º–æ–∫ 4:
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—ó: **80%**
- ‚ùå UTC: **0%**

**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 70%**

---

## 5. –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å —Ç–∞ –æ—Ñ–ª–∞–π–Ω

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –Ω–∞ backend:**
- ‚úÖ –í—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –º–∞—é—Ç—å `idempotency_key`
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–¥ INSERT
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –æ—Ñ–ª–∞–π–Ω:**
- ‚úÖ `idempotency_key` –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –Ω–∞ frontend
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è timestamp: `step-${id}-${Date.now()}`

### ‚ùå –ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–û—Ñ–ª–∞–π–Ω —á–µ—Ä–≥–∞ –Ω–∞ frontend:**
```
–¢–ó: "–ü—Ä–∏ –æ—Ñ–ª–∞–π–Ω-–Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ"
```
- ‚ùå –ù–µ–º–∞—î –æ—Ñ–ª–∞–π–Ω —á–µ—Ä–≥–∏ –¥–ª—è –≤–∏—Ä–æ–±–Ω–∏—á–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
- ‚ùå –ù–µ–º–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `AsyncStorage` –∞–±–æ `MMKV` –¥–ª—è –ø–∞—Ä—Ç—ñ–π
- ‚ùå –ù–µ–º–∞—î —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –ø—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è

**–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –º–æ–¥—É–ª–µ–º —Å–∫–ª–∞–¥—É:**
```typescript
// –í –º–æ–¥—É–ª—ñ —Å–∫–ª–∞–¥—É —î –æ—Ñ–ª–∞–π–Ω (app/(tabs)/operations.tsx):
const offlineQueue = await AsyncStorage.getItem('offlineQueue');

// –í –º–æ–¥—É–ª—ñ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞ –ù–ï–ú–ê–Ñ!
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –º–æ–¥—É–ª—é —Å–∫–ª–∞–¥—É:
```typescript
// –ü—Ä–∏ –≤—Ç—Ä–∞—Ç—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è
await AsyncStorage.setItem('production_queue', JSON.stringify([
  { type: 'batch_operation', data: {...}, idempotency_key }
]));

// –ü—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ
const queue = await AsyncStorage.getItem('production_queue');
for (const op of queue) {
  await fetch(`/api/production/batches/${id}/operations`, {
    body: JSON.stringify(op.data)
  });
}
```

### –ü—ñ–¥—Å—É–º–æ–∫ 5:
- ‚úÖ –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å: **100%**
- ‚ùå –û—Ñ–ª–∞–π–Ω: **0%**

**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 50%**

---

## 6. –¢—Ä–µ–π—Å—ñ–Ω–≥ —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞

### ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–¥—ñ–π –ø–∞—Ä—Ç—ñ—ó:**
- ‚úÖ API: `GET /api/production/batches/{id}/operations`
- ‚úÖ –í—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –¥–∞—Ç–∞–º–∏, –≤–∞–≥–∞–º–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ `step_order`

**–ó–≤'—è–∑–æ–∫ –∑ —Ä—É—Ö–∞–º–∏ —Å–∫–ª–∞–¥—É:**
- ‚úÖ `batch_materials.movement_id` –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ `stock_movements`
- ‚úÖ `stock_movements.metadata` –º—ñ—Å—Ç–∏—Ç—å `batch_id`, `batch_number`
- ‚úÖ –ú–æ–∂–Ω–∞ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ –≤—Å—ñ —Å–ø–∏—Å–∞–Ω–Ω—è/–ø—Ä–∏—Ö–æ–¥–∏

**–ë–∞–∑–æ–≤—ñ –∑–∞–ø–∏—Ç–∏:**
- ‚úÖ `GET /api/production/batches?status=created`
- ‚úÖ –§—ñ–ª—å—Ç—Ä –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º
- ‚úÖ –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –¥–∞—Ç–æ—é

### ‚ùå –ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

**–ó–≤—ñ—Ç–∏:**
```
–¢–ó: "–∑–∞–ø—Ä–æ—Å—ã/–æ—Ç—á—ë—Ç—ã, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ —É–≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç—É—Å—ã, –∫–ª—é—á–µ–≤—ã–µ –¥–∞—Ç—ã –∏ ¬´–≤—ã—Ö–æ–¥¬ª 
     –ø–æ –ø–∞—Ä—Ç–∏—è–º –∑–∞ –ø–µ—Ä–∏–æ–¥, —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –ø–æ —Ä–µ—Ü–µ–ø—Ç—É"
```
- ‚ùå –ù–µ–º–∞—î API –∑ —Ñ—ñ–ª—å—Ç—Ä–æ–º –∑–∞ –¥–∞—Ç–∞–º–∏ (start_date, end_date)
- ‚ùå –ù–µ–º–∞—î —Ñ—ñ–ª—å—Ç—Ä—É –∑–∞ recipe_id
- ‚ùå –ù–µ–º–∞—î –µ–∫—Å–ø–æ—Ä—Ç—É –≤ Excel/PDF
- ‚ùå –ù–µ–º–∞—î –∞–≥—Ä–µ–≥–æ–≤–∞–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Å–µ—Ä–µ–¥–Ω—ñ–π –≤–∏—Ö—ñ–¥, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä—Ç—ñ–π)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–æ–¥–∞—Ç–∏:
```python
@router.get("/batches/report")
async def get_batches_report(
    start_date: Optional[str] = None,
    end_date: Optional[str] = None,
    recipe_id: Optional[int] = None
):
    # –ü–æ–≤–µ—Ä—Ç–∞—î –∞–≥—Ä–µ–≥–æ–≤–∞–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    return {
        "total_batches": 10,
        "avg_yield": 75.5,
        "total_weight_produced": 500.0
    }
```

### –ü—ñ–¥—Å—É–º–æ–∫ 6:
- ‚úÖ –¢—Ä–µ–π—Å—ñ–Ω–≥: **100%**
- ‚ùå –ó–≤—ñ—Ç–∏/–∞–Ω–∞–ª—ñ—Ç–∏–∫–∞: **0%**

**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞: 50%**

---

## 7. –ü—Ä–∏–π–º–∞–ª—å–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó

| # | –ö—Ä–∏—Ç–µ—Ä—ñ–π | –°—Ç–∞—Ç—É—Å | –ö–æ–º–µ–Ω—Ç–∞—Ä |
|---|----------|--------|----------|
| 1 | –ü–∞—Ä—Ç—ñ—è –Ω–µ —Å—Ç–∞—Ä—Ç—É—î –ø—Ä–∏ –Ω—É–ª—ñ | ‚úÖ | –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ frontend |
| 2 | –ü–∞—Ä—Ç—ñ—è –Ω–µ —Å—Ç–∞—Ä—Ç—É—î –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—á—ñ | ‚ùå | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –í–Ü–î–°–£–¢–ù–Ø |
| 3 | –ú—ñ–∫—Å —Ñ—ñ–∫—Å—É—î—Ç—å—Å—è –æ–¥–∏–Ω —Ä–∞–∑ | ‚úÖ | –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –ø—Ä–∞—Ü—é—î |
| 4 | –û—Å—Ç–∞—Ç–æ–∫/–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –º—ñ–∫—Å –∑–≥—ñ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª | ‚úÖ | –§–æ—Ä–º—É–ª–∏ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ |
| 5 | –ü–æ–≤—Ç–æ—Ä —Å–ø–µ—Ü–∏–π –Ω–µ —Å—Ç–≤–æ—Ä—é—î –¥—É–±–ª—ñ–≤ | ‚úÖ | –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å |
| 6 | –ó–∞–∫—Ä–∏—Ç—Ç—è ‚Üí –ø—Ä–∏—Ö—ñ–¥ –ø—Ä–æ–¥—É–∫—Ç—É | ‚úÖ | 100% –ø—Ä–∞—Ü—é—î |
| 7 | –í–∏—Ö—ñ–¥ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è | ‚úÖ | –†–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —ñ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è |
| 8 | –ü–µ—Ä–µ—Å—á—ë—Ç –Ω–∞ –¥–∞—Ç—É —É–∑–≥–æ–¥–∂–µ–Ω–∏–π | ‚ö†Ô∏è | –ú–æ–∂–ª–∏–≤–æ, –∞–ª–µ API –Ω–µ–º–∞—î |
| 9 | –ü–æ–≤—Ç–æ—Ä–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –Ω–µ –∑–º—ñ–Ω—é—î —Å—Ç–∞–Ω | ‚úÖ | –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –≤—Å—é–¥–∏ |

**–ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤: 78%**

---

## –ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫

### –í—ñ–¥—Å–æ—Ç–æ–∫ —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó –ø–æ —Ä–æ–∑–¥—ñ–ª–∞—Ö:

| –†–æ–∑–¥—ñ–ª | –û—Ü—ñ–Ω–∫–∞ | –°—Ç–∞—Ç—É—Å |
|--------|--------|--------|
| 2.1 –°—Ç–∞—Ä—Ç –ø–∞—Ä—Ç—ñ—ó | 50% | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ |
| 2.2 –°–ø–µ—Ü–∏—ó/–º–∞—Ä–∏–Ω–∞–¥ | 50% | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ |
| 2.3 –ó–∞–∫—Ä–∏—Ç—Ç—è | 100% | ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é |
| 3. –î–∞–Ω—ñ –ø–∞—Ä—Ç—ñ—ó | 85% | ‚úÖ –ú–∞–π–∂–µ –ø–æ–≤–Ω—ñ—Å—Ç—é |
| 4. –Ü–Ω–≤–∞—Ä—ñ–∞–Ω—Ç–∏ | 70% | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ |
| 5. –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å/–æ—Ñ–ª–∞–π–Ω | 50% | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ |
| 6. –¢—Ä–µ–π—Å—ñ–Ω–≥/–∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ | 50% | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ |
| 7. –ü—Ä–∏–π–º–∞–ª—å–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó | 78% | ‚úÖ –ë—ñ–ª—å—à—ñ—Å—Ç—å |

### **–ó–ê–ì–ê–õ–¨–ù–ê –û–¶–Ü–ù–ö–ê: 67%** ‚ö†Ô∏è

---

## –ö—Ä–∏—Ç–∏—á–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (Must Have):

### üî¥ –í–∏—Å–æ–∫–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:

1. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–∏—à–∫—ñ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ –ø–∞—Ä—Ç—ñ—ó**
   - –§–∞–π–ª: `backend/production_api.py:create_batch`
   - –î–æ–¥–∞—Ç–∏ SELECT –∑ `stock_balances`

2. **Frontend —Ñ–æ—Ä–º–∞ –¥–ª—è —Å–ø–µ—Ü–∏–π/–º—ñ–∫—Å–∞**
   - –°—Ç–≤–æ—Ä–∏—Ç–∏: `frontend/app/batches/[id]/mix-form.tsx`
   - –ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–π –∑ —Ä–µ—Ü–µ–ø—Ç—É
   - –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–æ–¥–∏ –¥–ª—è –ø–∞–∂–∏—Ç–Ω–∏–∫–∞

3. **UTC –∑–∞–º—ñ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É**
   - –§–∞–π–ª: `backend/production_api.py`
   - –ó–∞–º—ñ–Ω–∏—Ç–∏ `GETDATE()` ‚Üí `GETUTCDATE()`

4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–ø–∏—Å–∞–Ω–Ω—è —Å–∏—Ä–æ–≤–∏–Ω–∏**
   - –í–∏–∫–ª–∏–∫–∞—Ç–∏ `/materials/consume` –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä—Ç—ñ—ó
   - –ê–±–æ –¥–æ–¥–∞—Ç–∏ –æ–∫—Ä–µ–º–∏–π –∫—Ä–æ–∫ –≤ UI

### üü° –°–µ—Ä–µ–¥–Ω—ñ–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:

5. **–û—Ñ–ª–∞–π–Ω —á–µ—Ä–≥–∞ –¥–ª—è –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞**
   - –§–∞–π–ª: `frontend/app/batches/[id].tsx`
   - AsyncStorage –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π

6. **–í–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ—Ü–µ–ø—Ç—ñ–≤**
   - –¢–∞–±–ª–∏—Ü—è: `recipes.version`
   - –¢–∞–±–ª–∏—Ü—è: `batches.recipe_version`

7. **–ó–≤—ñ—Ç–∏ —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞**
   - API: `/batches/report`
   - –§—ñ–ª—å—Ç—Ä–∏ –∑–∞ –¥–∞—Ç–∞–º–∏, —Ä–µ—Ü–µ–ø—Ç–∞–º–∏

8. **–ó–∞–±–æ—Ä–æ–Ω–∞ –º—ñ–∫—Å–∞ —è–∫ —Å–ø–µ—Ü–∏—ó**
   - –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤ seed —Ç–∞ API

### üü¢ –ù–∏–∑—å–∫–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:

9. **–í–≤—ñ–¥ –≤–æ–¥–∏ –ø—Ä–∏ –∑–∞—Å–æ–ª—Ü—ñ**
10. **–ï–∫—Å–ø–æ—Ä—Ç –∑–≤—ñ—Ç—ñ–≤ Excel/PDF**

---

## –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –¥—ñ—ó:

**–î–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è 90%+ —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó:**

1. –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –∑–∞–ª–∏—à–∫—ñ–≤ (2 –≥–æ–¥–∏–Ω–∏)
2. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–æ—Ä–º—É –º—ñ–∫—Å–∞ (4 –≥–æ–¥–∏–Ω–∏)
3. –í–∏–ø—Ä–∞–≤–∏—Ç–∏ UTC (30 —Ö–≤–∏–ª–∏–Ω)
4. –ê–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Å–ø–∏—Å–∞–Ω–Ω—è (1 –≥–æ–¥–∏–Ω–∞)

**–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ: 85% ‚Üí –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º–∏**

---

**–ê—É–¥–∏—Ç –≤–∏–∫–æ–Ω–∞–≤:** AI Agent  
**–°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç—É:** –ê–∫—Ç—É–∞–ª—å–Ω–∏–π  
**–ü–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≥–ª—è–¥—É:** –ü—ñ—Å–ª—è –¥–æ—Ä–æ–±–∫–∏ —Ñ—É–Ω–∫—Ü—ñ–π
