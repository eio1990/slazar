{
  "total": 17,
  "passed": 12,
  "failed": 5,
  "success_rate": 70.58823529411765,
  "results": [
    {
      "test": "Health Check",
      "success": true,
      "details": "Status: ok",
      "timestamp": "2025-11-12T13:27:05.366403",
      "response_data": {
        "status": "ok",
        "service": "warehouse-api"
      }
    },
    {
      "test": "GET /production/recipes",
      "success": true,
      "details": "Found 8 recipes with all required fields",
      "timestamp": "2025-11-12T13:27:06.560714",
      "response_data": {
        "count": 8,
        "sample": {
          "id": 3,
          "name": "\u0411\u0430\u0441\u0442\u0443\u0440\u043c\u0430 \u0437 \u043a\u043e\u043d\u0438\u043d\u0438 \u0432\u0430\u0433\u043e\u0432\u0430",
          "target_product_id": 108,
          "target_product_name": "\u0411\u0430\u0441\u0442\u0443\u0440\u043c\u0430 \u0437 \u043a\u043e\u043d\u0438\u043d\u0438 \u0432\u0430\u0433\u043e\u0432\u0430",
          "expected_yield_min": 67.0,
          "expected_yield_max": 68.0,
          "description": "\u0420\u0435\u0446\u0435\u043f\u0442 \u0434\u043b\u044f \u0411\u0430\u0441\u0442\u0443\u0440\u043c\u0430 \u0437 \u043a\u043e\u043d\u0438\u043d\u0438 \u0432\u0430\u0433\u043e\u0432\u0430",
          "steps": []
        }
      }
    },
    {
      "test": "GET /production/recipes/2",
      "success": true,
      "details": "Recipe '\u0411\u0430\u0441\u0442\u0443\u0440\u043c\u0430 \u043a\u043b\u0430\u0441\u0438\u0447\u043d\u0430' with 8 steps, ordered: True",
      "timestamp": "2025-11-12T13:27:07.890346",
      "response_data": {
        "recipe_name": "\u0411\u0430\u0441\u0442\u0443\u0440\u043c\u0430 \u043a\u043b\u0430\u0441\u0438\u0447\u043d\u0430",
        "steps_count": 8
      }
    },
    {
      "test": "POST /production/batches",
      "success": false,
      "details": "Invalid batch format or status. Number: BAST-12112025-5, Status: created",
      "timestamp": "2025-11-12T13:27:10.689375",
      "response_data": {
        "id": 16,
        "batch_number": "BAST-12112025-5",
        "recipe_id": 2,
        "recipe_name": "\u0411\u0430\u0441\u0442\u0443\u0440\u043c\u0430 \u043a\u043b\u0430\u0441\u0438\u0447\u043d\u0430",
        "status": "created",
        "current_step": 0,
        "started_at": "2025-11-12T15:27:09.436666",
        "completed_at": null,
        "initial_weight": 100.0,
        "final_weight": null,
        "trim_waste": null,
        "trim_returned": false,
        "operator_notes": "Test batch for API testing"
      }
    },
    {
      "test": "GET /production/batches",
      "success": true,
      "details": "Retrieved 7 batches",
      "timestamp": "2025-11-12T13:27:11.870900",
      "response_data": {
        "count": 7
      }
    },
    {
      "test": "GET /production/batches?status=created",
      "success": true,
      "details": "Retrieved 3 created batches",
      "timestamp": "2025-11-12T13:27:13.089862",
      "response_data": {
        "count": 3
      }
    },
    {
      "test": "GET /production/batches/{id}",
      "success": false,
      "details": "No batch ID available from previous test",
      "timestamp": "2025-11-12T13:27:13.089902",
      "response_data": null
    },
    {
      "test": "PUT /production/batches/{id}/complete",
      "success": false,
      "details": "No batch ID available from previous test",
      "timestamp": "2025-11-12T13:27:13.089911",
      "response_data": null
    },
    {
      "test": "Spice Deduction - Create Batch",
      "success": true,
      "details": "Created test batch BAST-12112025-6 (ID: 17)",
      "timestamp": "2025-11-12T13:27:15.883479",
      "response_data": null
    },
    {
      "test": "Spice Deduction - Recipe Spices Check",
      "success": true,
      "details": "All 5 expected spices found with correct quantities",
      "timestamp": "2025-11-12T13:27:17.261286",
      "response_data": null
    },
    {
      "test": "Spice Deduction - Initial Balances",
      "success": true,
      "details": "Retrieved initial balances for 5 spices",
      "timestamp": "2025-11-12T13:27:23.215295",
      "response_data": null
    },
    {
      "test": "Spice Deduction - Mix Production",
      "success": true,
      "details": "Mix production successful: Mix produced successfully",
      "timestamp": "2025-11-12T13:27:27.501075",
      "response_data": null
    },
    {
      "test": "Spice Deduction - Balance Verification",
      "success": true,
      "details": "\u2705 \u0411\u043e\u0440\u043e\u0448\u043d\u043e: 80.0 \u2192 76.92 (deducted 3.08); \u2705 \u041f\u0430\u0436\u0438\u0442\u043d\u0438\u043a: 69.0 \u2192 59.77 (deducted 9.23); \u2705 \u041f\u0430\u043f\u0440\u0438\u043a\u0430: 138.0 \u2192 133.38 (deducted 4.62); \u2705 \u041f\u0435\u0440\u0435\u0446\u044c \u0447\u0456\u043b\u0456: 80.0 \u2192 78.46 (deducted 1.54); \u2705 \u0427\u0430\u0441\u043d\u0438\u043a: 127.0 \u2192 120.85 (deducted 6.15)",
      "timestamp": "2025-11-12T13:27:28.685421",
      "response_data": null
    },
    {
      "test": "Spice Deduction - Stock Movements",
      "success": false,
      "details": "Expected at least 5 spice movements, found 0",
      "timestamp": "2025-11-12T13:27:29.881237",
      "response_data": null
    },
    {
      "test": "Spice Deduction Edge Cases",
      "success": false,
      "details": "\u274c Failed to create test batch for insufficient stock test: 400; \u274c Failed to create batch for idempotency test: 400; \u2705 Zero initial weight handled gracefully",
      "timestamp": "2025-11-12T13:27:39.954198",
      "response_data": null
    },
    {
      "test": "Edge Cases",
      "success": true,
      "details": "\u2705 Invalid recipe ID returns 404; \u2705 Non-existent recipe returns 404; \u2705 Non-existent batch returns 404",
      "timestamp": "2025-11-12T13:27:43.504665",
      "response_data": null
    },
    {
      "test": "Database Verification",
      "success": true,
      "details": "Found 2 finished products with stock",
      "timestamp": "2025-11-12T13:27:44.691280",
      "response_data": {
        "finished_products_count": 2
      }
    }
  ]
}