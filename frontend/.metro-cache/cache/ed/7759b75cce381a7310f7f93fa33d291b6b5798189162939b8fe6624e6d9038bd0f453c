{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":65,"index":65}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../createMMKV/getDefaultMMKVInstance","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":66},"end":{"line":2,"column":77,"index":143}}],"key":"DiSZT0xdzLAiN93w0d0GfoSFlyA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.createMMKVHook = createMMKVHook;\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[1], \"react\");\n  var _createMMKVGetDefaultMMKVInstance = require(_dependencyMap[2], \"../createMMKV/getDefaultMMKVInstance\");\n  function createMMKVHook(getter) {\n    return (key, instance) => {\n      var mmkv = instance ?? (0, _createMMKVGetDefaultMMKVInstance.getDefaultMMKVInstance)();\n      var _useState = (0, _react.useState)(0),\n        _useState2 = (0, _slicedToArray.default)(_useState, 2),\n        bump = _useState2[0],\n        setBump = _useState2[1];\n      var value = (0, _react.useMemo)(() => {\n        // bump is here as an additional outside dependency, so this useMemo\n        // re-computes the value each time bump changes, effectively acting as a hint\n        // that the outside value (storage) has changed. setting bump refreshes this value.\n        bump;\n        return getter(mmkv, key);\n      }, [mmkv, key, bump]);\n\n      // update value by user set\n      var set = (0, _react.useCallback)(v => {\n        var newValue = typeof v === 'function' ? v(getter(mmkv, key)) : v;\n        switch (typeof newValue) {\n          case 'number':\n          case 'string':\n          case 'boolean':\n            mmkv.set(key, newValue);\n            break;\n          case 'undefined':\n            mmkv.remove(key);\n            break;\n          case 'object':\n            if (newValue instanceof ArrayBuffer) {\n              mmkv.set(key, newValue);\n              break;\n            } else {\n              throw new Error(`MMKV: Type object (${newValue}) is not supported!`);\n            }\n          default:\n            throw new Error(`MMKV: Type ${typeof newValue} is not supported!`);\n        }\n      }, [key, mmkv]);\n\n      // update value if it changes somewhere else (second hook, same key)\n      (0, _react.useEffect)(() => {\n        var listener = mmkv.addOnValueChangedListener(changedKey => {\n          if (changedKey === key) {\n            setBump(b => b + 1);\n          }\n        });\n        return () => listener.remove();\n      }, [key, mmkv]);\n      return [value, set];\n    };\n  }\n});","lineCount":68,"map":[[12,2,5,0,"exports"],[12,9,5,0],[12,10,5,0,"createMMKVHook"],[12,24,5,0],[12,27,5,0,"createMMKVHook"],[12,41,5,0],[13,2,66,1],[13,6,66,1,"_babelRuntimeHelpersSlicedToArray"],[13,39,66,1],[13,42,66,1,"require"],[13,49,66,1],[13,50,66,1,"_dependencyMap"],[13,64,66,1],[14,2,66,1],[14,6,66,1,"_slicedToArray"],[14,20,66,1],[14,23,66,1,"_interopDefault"],[14,38,66,1],[14,39,66,1,"_babelRuntimeHelpersSlicedToArray"],[14,72,66,1],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_createMMKVGetDefaultMMKVInstance"],[16,39,2,0],[16,42,2,0,"require"],[16,49,2,0],[16,50,2,0,"_dependencyMap"],[16,64,2,0],[17,2,5,7],[17,11,5,16,"createMMKVHook"],[17,25,5,30,"createMMKVHook"],[17,26,9,2,"getter"],[17,32,9,44],[17,34,9,46],[18,4,10,2],[18,11,10,9],[18,12,11,4,"key"],[18,15,11,15],[18,17,12,4,"instance"],[18,25,12,19],[18,30,13,58],[19,6,14,4],[19,10,14,10,"mmkv"],[19,14,14,14],[19,17,14,17,"instance"],[19,25,14,25],[19,29,14,29],[19,33,14,29,"getDefaultMMKVInstance"],[19,66,14,51],[19,67,14,51,"getDefaultMMKVInstance"],[19,89,14,51],[19,91,14,52],[19,92,14,53],[20,6,16,4],[20,10,16,4,"_useState"],[20,19,16,4],[20,22,16,28],[20,26,16,28,"useState"],[20,32,16,36],[20,33,16,36,"useState"],[20,41,16,36],[20,43,16,37],[20,44,16,38],[20,45,16,39],[21,8,16,39,"_useState2"],[21,18,16,39],[21,25,16,39,"_slicedToArray"],[21,39,16,39],[21,40,16,39,"default"],[21,47,16,39],[21,49,16,39,"_useState"],[21,58,16,39],[22,8,16,11,"bump"],[22,12,16,15],[22,15,16,15,"_useState2"],[22,25,16,15],[23,8,16,17,"setBump"],[23,15,16,24],[23,18,16,24,"_useState2"],[23,28,16,24],[24,6,17,4],[24,10,17,10,"value"],[24,15,17,15],[24,18,17,18],[24,22,17,18,"useMemo"],[24,28,17,25],[24,29,17,25,"useMemo"],[24,36,17,25],[24,38,17,26],[24,44,17,32],[25,8,18,6],[26,8,19,6],[27,8,20,6],[28,8,21,6,"bump"],[28,12,21,10],[29,8,22,6],[29,15,22,13,"getter"],[29,21,22,19],[29,22,22,20,"mmkv"],[29,26,22,24],[29,28,22,26,"key"],[29,31,22,29],[29,32,22,30],[30,6,23,4],[30,7,23,5],[30,9,23,7],[30,10,23,8,"mmkv"],[30,14,23,12],[30,16,23,14,"key"],[30,19,23,17],[30,21,23,19,"bump"],[30,25,23,23],[30,26,23,24],[30,27,23,25],[32,6,25,4],[33,6,26,4],[33,10,26,10,"set"],[33,13,26,13],[33,16,26,16],[33,20,26,16,"useCallback"],[33,26,26,27],[33,27,26,27,"useCallback"],[33,38,26,27],[33,40,27,7,"v"],[33,41,27,20],[33,45,27,25],[34,8,28,8],[34,12,28,14,"newValue"],[34,20,28,22],[34,23,28,25],[34,30,28,32,"v"],[34,31,28,33],[34,36,28,38],[34,46,28,48],[34,49,28,51,"v"],[34,50,28,52],[34,51,28,53,"getter"],[34,57,28,59],[34,58,28,60,"mmkv"],[34,62,28,64],[34,64,28,66,"key"],[34,67,28,69],[34,68,28,70],[34,69,28,71],[34,72,28,74,"v"],[34,73,28,75],[35,8,29,8],[35,16,29,16],[35,23,29,23,"newValue"],[35,31,29,31],[36,10,30,10],[36,15,30,15],[36,23,30,23],[37,10,31,10],[37,15,31,15],[37,23,31,23],[38,10,32,10],[38,15,32,15],[38,24,32,24],[39,12,33,12,"mmkv"],[39,16,33,16],[39,17,33,17,"set"],[39,20,33,20],[39,21,33,21,"key"],[39,24,33,24],[39,26,33,26,"newValue"],[39,34,33,34],[39,35,33,35],[40,12,34,12],[41,10,35,10],[41,15,35,15],[41,26,35,26],[42,12,36,12,"mmkv"],[42,16,36,16],[42,17,36,17,"remove"],[42,23,36,23],[42,24,36,24,"key"],[42,27,36,27],[42,28,36,28],[43,12,37,12],[44,10,38,10],[44,15,38,15],[44,23,38,23],[45,12,39,12],[45,16,39,16,"newValue"],[45,24,39,24],[45,36,39,36,"ArrayBuffer"],[45,47,39,47],[45,49,39,49],[46,14,40,14,"mmkv"],[46,18,40,18],[46,19,40,19,"set"],[46,22,40,22],[46,23,40,23,"key"],[46,26,40,26],[46,28,40,28,"newValue"],[46,36,40,36],[46,37,40,37],[47,14,41,14],[48,12,42,12],[48,13,42,13],[48,19,42,19],[49,14,43,14],[49,20,43,20],[49,24,43,24,"Error"],[49,29,43,29],[49,30,44,16],[49,52,44,38,"newValue"],[49,60,44,46],[49,81,45,14],[49,82,45,15],[50,12,46,12],[51,10,47,10],[52,12,48,12],[52,18,48,18],[52,22,48,22,"Error"],[52,27,48,27],[52,28,48,28],[52,42,48,42],[52,49,48,49,"newValue"],[52,57,48,57],[52,77,48,77],[52,78,48,78],[53,8,49,8],[54,6,50,6],[54,7,50,7],[54,9,51,6],[54,10,51,7,"key"],[54,13,51,10],[54,15,51,12,"mmkv"],[54,19,51,16],[54,20,52,4],[54,21,52,5],[56,6,54,4],[57,6,55,4],[57,10,55,4,"useEffect"],[57,16,55,13],[57,17,55,13,"useEffect"],[57,26,55,13],[57,28,55,14],[57,34,55,20],[58,8,56,6],[58,12,56,12,"listener"],[58,20,56,20],[58,23,56,23,"mmkv"],[58,27,56,27],[58,28,56,28,"addOnValueChangedListener"],[58,53,56,53],[58,54,56,55,"changedKey"],[58,64,56,65],[58,68,56,70],[59,10,57,8],[59,14,57,12,"changedKey"],[59,24,57,22],[59,29,57,27,"key"],[59,32,57,30],[59,34,57,32],[60,12,58,10,"setBump"],[60,19,58,17],[60,20,58,19,"b"],[60,21,58,20],[60,25,58,25,"b"],[60,26,58,26],[60,29,58,29],[60,30,58,30],[60,31,58,31],[61,10,59,8],[62,8,60,6],[62,9,60,7],[62,10,60,8],[63,8,61,6],[63,15,61,13],[63,21,61,19,"listener"],[63,29,61,27],[63,30,61,28,"remove"],[63,36,61,34],[63,37,61,35],[63,38,61,36],[64,6,62,4],[64,7,62,5],[64,9,62,7],[64,10,62,8,"key"],[64,13,62,11],[64,15,62,13,"mmkv"],[64,19,62,17],[64,20,62,18],[64,21,62,19],[65,6,64,4],[65,13,64,11],[65,14,64,12,"value"],[65,19,64,17],[65,21,64,19,"set"],[65,24,64,22],[65,25,64,23],[66,4,65,2],[66,5,65,3],[67,2,66,0],[68,0,66,1],[68,3]],"functionMap":{"names":["<global>","createMMKVHook","<anonymous>","useMemo$argument_0","set","useEffect$argument_0","mmkv.addOnValueChangedListener$argument_0","setBump$argument_0"],"mappings":"AAA;OCI;SCK;0BCO;KDM;MEI;OFuB;cGK;sDCC;kBCE,YD;ODE;aHC,uBG;KHC;GDG;CDC"},"hasCjsExports":false},"type":"js/module"}]}